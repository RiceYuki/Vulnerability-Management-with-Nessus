# Vulnerability Management with Nessus
**Eric Pham**

**Personal Project**

**October 28, 2023**

<h2>Introduction</h2>
In the dynamic realm of cybersecurity, vulnerability management plays a pivotal role in safeguarding systems and networks. It encompasses the critical steps of discovering, prioritizing, assessing, reporting, remediating, and verifying, providing a robust framework to address vulnerabilities effectively. This project is a detailed walkthrough that showcases the practical implementation of this framework using Nessus Essentials, a renowned vulnerability scanner, and a Windows 10 virtual machine for testing.
<h2>Project Walkthrough</h2>

**Setting up Nessus Essentials** 
- Installed Nessus Essentials on my local computer.
- Connected to SSL which initialized and installed plugins.

**Setting up the Virtual Machine**
- Installed VMware Workstation 17 Player (latest version at this time).
 -Installed Windows 10 ISO.
- Configured the Network Adapter by enabling Bridged which puts the virtual machine(VM) on the same network as my home computer. This allows Nessus implementation to communicate to the virtual machine more easily. 
Set the Windows name and password credentials to ‘admin’ and ‘password’

**Connectivity with Virtual Machine**
- Opened up Command Prompt on the VM and typed ‘ipconfig’ onto the command line to get the IPv4 Address.
<img src="https://i.imgur.com/UxEqiDm.png?1" height="60%" width="60%"/>

- Opened up Command Prompt on my local computer and used the command ‘ping’ to see if we could reach the VM network.
<img src="https://i.imgur.com/JEUv7LJ.png" height="60%" width="60%"/>
Note: -t is telling the command to keep going forever until the user cancels it

- It was timing out so I disabled the firewall on the VM by opening Windows Defender Firewall and navigating to ‘Windows Defender Firewall Properties’ which is where I would turn off the firewall on domain, private, and public profiles.
<img src="https://i.imgur.com/V12JYrj.png" height="60%" width="60%"/>

- After changing the firewall settings, I pinged the VM network from my local computer again and I was able to reach it.
<img src="https://i.imgur.com/OoUclin.png" height="60%" width="60%"/>

**Scanning and Inspecting in Nessus w/o Credentials**

- Opened Nessus Essentials and created a new Basic Network Scan by name and the VM IPv4 as a target. For the 1st scan, I will not be adding the credentials.
<img src="https://i.imgur.com/X1uKiwD.png" height="60%" width="60%"/>

- I ran the scan and after a few minutes, I received the results indicating that there was not really a vulnerability in the VM. Depending on the organization, some only take action on critical and high vulnerabilities since they would appear a lot resulting in not touching medium or low vulnerabilities.
<img src="https://i.imgur.com/ROBcJeg.png" height="60%" width="60%"/>

- Navigating to the vulnerabilities tab, it displays each vulnerability which the user can click to see how they implicate a solution to remediate that type of vulnerability.
<img src="https://i.imgur.com/fdYE8RZ.png" height="60%" width="60%"/>

Note: ‘Info’ doesn't necessarily be a vulnerability but details to be aware of.

**Configuring, Scanning, and Inspecting in Nessus w/ Credentials**
- Opened ‘Services’ in the VM and enabled Remote Registry. This allows the scanner to connect to the computer’s registry and look for insecure configurations.
<img src="https://i.imgur.com/oXpWF0b.png" height="60%" width="60%"/>

- Opened User Account Control Settings on the VM and set it to ‘Never notify’ which allows us to scan it because the computer is not on a domain.
- Opened ‘Registry Editor’ in the VM and navigated to Computer/HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System which is where I added a key that further disables user account control for the remote account that is going to be used to connect to the computer during the Nessus scan. For the key, I created a DWORD called LocalAccountTokenFilterPolicy and set the value to 1. (community.tenable.com)
<img src="https://i.imgur.com/c1lmAPE.png" height="60%" width="60%"/>

- Restarted the VM and configured Nessus by adding the VM’s Windows credentials.
<img src="https://i.imgur.com/VkteUin.png" height="60%" width="60%"/>

- I ran the scan with the credentials and the results were a lot different compared to the 1st scan. There are now vulnerabilities rated as ‘Critical’ and ‘High’.
<img src="https://i.imgur.com/8RFGrBX.png" height="60%" width="60%"/>

- There’s also a ‘Remediations’ tab now which gives me high-level instructions on how to remediate most of the findings. In this scan, Nessus is suggesting to update Windows to remediate the majority of the vulnerabilities.
<img src="https://i.imgur.com/nj7jB9Q.png" height="60%" width="60%"/>

- I will remediate it later on in the project.

**Install Deprecated Firefox, Scanning, and Inspecting in Nessus**
- Installed Firefox version 3.6.12 onto the VM
<img src="https://i.imgur.com/ZDiXkiw.png" height="60%" width="60%"/>

- I ran the scan and there are significantly more vulnerabilities just from installing a deprecated version of Firefox. Compared to the previous scan, before installing deprecated Firefox, the VM went from 9 critical vulnerabilities to 86 and 37 high vulnerabilities to 92.
<img src="https://i.imgur.com/Xz7i6Cg.png" height="60%" width="60%"/>

- Navigated to the ‘Remediations’ tab in Nessus and at the top, it’s now suggesting upgrading Firefox.
<img src="https://i.imgur.com/dIfY2dD.png" height="60%" width="60%"/>

**Remediating Some Vulnerabilities on the VM**
- Since Nessus is suggesting to upgrade Firefox, I have 2 options. I can either uninstall Firefox completely or install the latest version. In this case, I upgraded Firefox to the latest version.
<img src="https://i.imgur.com/jxuuZmJ.png" height="60%" width="60%"/>

- I navigated to ‘Windows Update’ on the VM then clicked ‘Check for updates’ and downloaded the updates. Once downloaded, I restarted the VM. I repeated this until Windows displayed ‘You’re up to date’ when clicking ‘Check for updates’. 
<img src="https://i.imgur.com/wotbEsV.png" height="60%" width="60%"/>

**Scanning and Inspecting After Remidating Some Vulnerabilities in Nessus**
- I ran the scan and the results were significant. There are now only 3 critical vulnerabilities and 9 high vulnerabilities. That’s less than the 2nd scan(9 critical, 37 high) with the credentials and significantly less than the 3rd scan(86 criticals, 92 high) with deprecated Firefox.
<img src="https://i.imgur.com/8UnZg0a.png" height="60%" width="60%"/>

- Although there are some vulnerabilities left, I’m satisfied with the result of the remediations which remediated 93.26% of the vulnerabilities.

<h2>Summary</h2>

This project is a step-by-step walkthrough that documents the process of setting up and securing a Windows 10 virtual machine with Nessus Essentials for vulnerability assessment. It underscores the significance of credentials and configurations in vulnerability management. 

In the initial phase, I established a Windows 10 virtual machine using VMware Workstation and configured network settings for communication between the host and the virtual machine.

Initially, I encountered connectivity issues, which were resolved by disabling the virtual machine's firewall, enabling successful communication between the host and the virtual machine.

For the first scan, I employed Nessus without credentials, revealing a lack of critical vulnerabilities, and underscoring the importance of authenticated scans for a comprehensive assessment.

To enhance the depth of assessment, I enabled the Remote Registry and adjusted User Account Control settings on the virtual machine, allowing Nessus to conduct authenticated scans. This revealed critical and high vulnerabilities not apparent in the initial scan.

As a real-world simulation, I introduced vulnerabilities by installing a deprecated version of Firefox, leading to a significant rise in vulnerabilities.

In line with the remediation step of the vulnerability management framework, I addressed the Firefox vulnerability by upgrading the browser and ensuring the Windows system was up to date. This resulted in a substantial reduction in critical and high vulnerabilities, remediating 93.26% of the vulnerabilities.

Following the implementation of remediations, another scan was conducted, leading to a remarkable reduction in vulnerabilities. This highlights the efficacy of proactive vulnerability management.

In conclusion, this project is a comprehensive walkthrough that showcases the practical application of a vulnerability management framework. By following the steps of Discover, Prioritize, Assess, Report, Remediate, and Verify, organizations can proactively identify and mitigate vulnerabilities, bolstering their cybersecurity posture.

<h2>Alternative Project Link</h2>
If you find the pictures to be too blurry, I have linked a Google document that has better-quality pictures with the exact same project content. 

https://docs.google.com/document/d/1JASptXCLM7XECYWIg_h_5u0O8_xUMrhDBc02uAY8pDI/edit?usp=sharing
<h2>Sources</h2>

https://www.vmware.com/

https://www.tenable.com/products/nessus/nessus-essentials

https://www.microsoft.com/en-us/software-download/windows10

https://www.tenable.com/products/nessus/nessus-essentials

https://ftp.mozilla.org/pub/firefox/releases/3.6.12/win32/en-US/

https://community.tenable.com/s/article/Scanning-with-non-default-Windows-Administrator-Account?language=en_US
